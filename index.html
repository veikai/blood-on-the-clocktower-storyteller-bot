<!-- Websocket 的使用示例 -->
<!DOCTYPE html>
<html lang="zh_CN">
<head>
  <meta charset="UTF-8">
  <title>测试Socket——ws://127.0.0.1:8181</title>
  <script>
    var socket;
    var index;
    if ("WebSocket" in window) {
      var ws = new WebSocket("ws://127.0.0.1:8181/test");
      socket = ws;
      ws.onopen = function() {
        document.getElementById("showMes").value+="与服务器连接成功\n";
      };
      ws.onmessage = function(evt) {
        var message = evt.data;
        if (message.startsWith("欢迎来到")){
          index = message.split("#")[1]
        }
        document.getElementById("showMes").value+=message+"\n";
      };
      ws.onclose = function() {
        document.getElementById("showMes").value+="与服务器断开连接\n";
      };
    } else {
      alert("浏览器不支持WebSocket");
    }
    function sendMeg(){
      var message = document.getElementById("mes").value + "#" + index;
      document.getElementById("showMes").value+=message+"\n";
      socket.send(message);
      document.getElementById("mes").value = "";
    }
  </script>
</head>
<body>
  <textarea rows="3" cols="30" id="showMes" style="width:300px;height:500px;" readonly></textarea>
  <br/>
  <label>消息</label>
  <input type="text" id="mes"/>
  <button onclick="sendMeg();">发送</button>
</body>
</html>